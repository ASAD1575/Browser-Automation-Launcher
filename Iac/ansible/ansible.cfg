[defaults]

Use the dynamic inventory script as the primary inventory source

inventory = inventory/ec2.py

CRITICAL: Explicitly set the connection type for all hosts (overridden only by hostvars)

transport = aws_ssm

CRITICAL: Define the default user for the remote Windows machine.

This ensures the SSM connection plugin has a valid context to run the initial command.

remote_user = Administrator

host_key_checking = False
interpreter_python = auto_silent
gather_facts = False # Added for performance, as you set it in the playbook too

We can remove [ssh_connection] since we are using SSM

[plugin_aws_ssm]

AWS SSM connection plugin configuration

This section is correct, but doesn't need additional settings

since shell/platform are defined in the dynamic inventory (ec2.py).